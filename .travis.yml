language: go
go:
  - "1.3.3"
  - "1.4.3"
  - "1.5.2"
  - "1.6.2"
  - "1.7.1"
  - tip
install:
  - go get ./...
  - go tool -n cover || go get -v golang.org/x/tools/cmd/cover
script:
  - go test -v -race -coverprofile=coverage.txt -covermode=count ./...
after_success:
  - bash <(curl -s https://codecov.io/bash)

matrix:
  include:
  # no code coverage for go 1.2
  - go: 1.2.2
    install: go get ./...
    script: go test -v ./...
    after_success: 'true'
